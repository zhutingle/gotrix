<?xml version="1.0" encoding="UTF-8" ?>
<funcs>

	<func id="2000" name="access_token" des="从微信公众平台获取access_token" private="true" cron="0 0 * * * *">
		<job result="access_token">get('access_token')</job>
		<job>Neq(${access_token},null,'access_token 已存在')</job>

		<job result="appid">Config('Appid')</job>
		<job result="appSecret">Config('AppSecret')</job>
		<job result="url"><![CDATA[Sprintf('https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=%s&secret=%s',${appid},${appSecret})]]></job>
		<job result="result">HttpGet(${url})</job>
		<job result="json">ToJson(${result})</job>

		<job result="access_token">Jget(${json},'access_token')</job>
		<job result="expires_in">Jget(${json},'expires_in')</job>
		<job>setex('access_token',3600,${access_token})</job>
	</func>

</funcs>
